
- [5장. 고급 함수와 함수형 프로그래밍 활용하기](#5장-고급-함수와-함수형-프로그래밍-활용하기)
  - [5.1. 코틀린을 활용한 함수형 프로그래밍](#51-코틀린을-활용한-함수형-프로그래밍)
    - [5.1.1 고차 함수(High order Function)](#511-고차-함수high-order-function)
  - [5.2. 확장](#52-확장)
  - [5.3 확장 프로퍼티](#53-확장-프로퍼티)
  - [5.4 동반 확장](#54-동반-확장)
  - [5.5 수신객체가 있는 호출 가능 참조](#55-수신객체가-있는-호출-가능-참조)

---

# 5장. 고급 함수와 함수형 프로그래밍 활용하기

고차 함수(high order function), 람다, 확장 람다, 확장 함수와 프로퍼티, 익명함수, inline function 등에 대해 알아본다.

## 5.1. 코틀린을 활용한 함수형 프로그래밍

- 함수형 언어는 함수를 일급 시민(first class) 값으로 취급한다.
- 이 말은 함수를 다른 일반적인 타입의 값과 똑같이 취급한다는 뜻이다.
- 특히 **`일급 시민`** 이라는 말에는 **변수에 값을 대입하거나, 변수에서 값을 읽을 수 있고, 함수에 값을 전달하거나 함수가 값을 반환할 수 있다는 뜻**이 들어있다.
- **이런 성질로 인해 함수인 값을 데이터와 마찬가지로 조작할 수 있는 고차 함수라는 함수를 정의할 수 있게 해주며, 코드 추사화 및 합성을 더 쉽게 가능하도록 유연성을 제공해준다.**

### 5.1.1 고차 함수(High order Function)

앞서 람다를 통해 배열 생성자 예제를 본 적이 있었을 것이다.

```kt
val squares = IntArray(5) { n -> n*n } // 0, 1, 4, 9, 16
```

만약 어떤 정수 배열의 원소의 합계를 계산하는 함수를 정의하고 싶다고 하자.

```kt
fun sum(numbers: IntArray) : Int {
    var result = numbers.firstOrNull() ?: throw IllegalArgumentException("Empty array")

    for (i in 1..numbers.lastIndex) result += numbers[i]

    return result
}

fun main() {
    println(sum(intArrayOf(1,2,3))) // 6
}
```

만약 여기에서 기능을 확장해서, 곱셈/최댓값/최솟값 등 다양한 집계 함수를 사용하게 하려면 어떻게 해야 할까?

함수 자체의 기본적인 루프 로직은 그대로 두고, 중간 값들을 함수의 파라미터로 추출한 다음, 일반화한 함수를 호출할 때 이 파라미터에 적당한 연산을 제공하면 된다.

```kt
fun aggregate(numbers: IntArray, op: (Int, Int) -> Int): Int {
    var result = numbers.firstOrNull() ?: throw IllegalArgumentException("Empty array")
    
    for (i in 1..numbers.lastIndex) result = op(result, numbers[i])
    
    return result
}

fun sum(numbers: IntArray) = aggregate(numbers, { result, op -> result + op })

fun max(numbers: IntArray) = aggregate(numbers, { result, op -> if(op > result) op else result })

fun main() {
    println(sum(intArrayOf(1, 2, 3))) // 6
    println(max(intArrayOf(1, 2, 3))) // 3
}
```

- op 파라미터가 다른 파라미터와 다른 점은, **이 파라미터를 표현하는 타입이 함수 타입인 (Int, Int) -> Int 라는 점뿐이다.**
- 이 말은 op를 함수처럼 호출할 수 있다는 뜻이다.
- 이 예제에서 op 파라미터는 Int 값을 한 쌍 받아서, Int를 결과로 내놓는 함수가 된다.
- `sum()`과 `max()` 함수를 보면, aggregate를 호출하는 쪽에서는 **함숫값을 표현하는 람다식을 인자로 넘긴다는 사실**을 알 수 있다.
- 람다식이란 기본적으로 단순한 형태의 문법을 사용해 정의하는 이름이 없는 지역함수이다.

```kt
{ result, op -> result + op }
```

- `result`와 `op`는 함수 파라미터 역할을 하며, `->` 다음에 오는 식은 결과를 계산하는 식이다.
- 이 경우 명시적인 return이 불필요하다. 그리고 컴파일러는 파라미터 타입을 문맥으로부터 추론해준다.


## 5.2. 확장
## 5.3 확장 프로퍼티
## 5.4 동반 확장
## 5.5 수신객체가 있는 호출 가능 참조
